---
title: "Final Project Graphs"
author: "Brian Anderson and Daniel Beidelshcies"
output: 
  html_document:
    df_print: paged
    code_download: true
    theme: cerulean
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, error=TRUE, message=FALSE, warning=FALSE)
```

```{r libraries}
library(tidyverse)     # for graphing and data cleaning
library(lubridate)     # for date manipulation
library(ggthemes)      # for even more plotting theme
library(gganimate)     # for adding animation layers to ggplots
library(transformr)    # for "tweening" (gganimate)
library(gifski)        # for creating the gif
library(shiny)         # for creating interactive apps
library(readr)
theme_set(theme_minimal()) # My favorite ggplot() theme :)
```

## Data choice: Video Game Sales

```{r}
vgsales <- read_csv("vgsales.csv", col_types = cols(Year = col_number()))
vgsales
```

### Final Project Outline

#### Title: 

In the YAML section of the document. A descriptive title & list of all group members.

*Exploring the World of Video Games*

Daniel Beidelschies and Brian Anderson

#### Introduction and Background: 

An introduction that motivates & outlines a clear, specific set of research questions. Also, provide some background on your topic.

##### Introduction

Since the advancement of technology, the creation of video games has played an influential role in being a source of entertainment for everyone around the world. From the multitude of video games that have been created, everyone is able to find something that they enjoy in order to pass time, have fun, and fulfill their creative needs. With this idea, we want to look at how well different games, genres, and platforms did when it came to releasing games for everyone to play. This will allow us to understand how popularity ranks up between different types of games based on the sales around of the world. 

##### Background information

Since our individual discovery, we have always had interest in video games and wondered how the sales of these games differed across the world as we grew up in different regions. 

#### Research Questions

What are the most popular games over the years?

What are the most selling platforms of games over the years across different regions?

What is the most selling genre of games over the years across different regions?

Who is the most selling publisher of games over the years across different regions?

#### Data collection: 

Specification of your data sources and collection process.

Scraping from Kaggle and importing to a dataset

#### Analysis: 

This is the bulk of the report which either has a presentation of the groupâ€™s key findings and take-aways or gives the detail of how someone would interact and what people should take away from the shiny app. If you choose to do a shiny app, be sure to include a link to the shinyapps.io site.


```{r, fig.alt = "Animated Bar Chart showin cumulative video game sales by genre from 1980-2020.", echo=FALSE}
vgsales %>%
  group_by( Year,Genre) %>% 
  summarize(total_genre_sum = sum(Global_Sales)) %>% 
  ungroup() %>% 
  complete(Year,Genre) %>% 
  arrange(Genre,Year) %>% 
  group_by(Genre) %>% 
  replace_na(list(total_genre_sum = 0)) %>% 
  mutate(cum_genre_sum = cumsum(total_genre_sum)) %>%
  filter(cum_genre_sum > 0) %>% 
  filter(n() >= 13) %>% 
  arrange(Year,desc(cum_genre_sum)) %>%
  drop_na() %>% 
  mutate(rank = 1:n()) %>% 
  ggplot(aes(x = Year,
             y = cum_genre_sum,
             color = Genre)) +
  geom_line(size =1.5) +
  labs(title = "Popular Video Game Genres based on Worldwide Sales",
       subtitle = "Year: {frame_along}",
       x = "", 
       y = "",
       caption = "Plot created by D.B. & B.A., Data from Vgsales") +
  scale_color_manual(values = c("red", "green","blue","black", "yellow","deeppink","cyan","darkmagenta","steelblue","midnightblue","sienna", "green4"))+
  transition_reveal(Year)
```

When did each genre become popular?

action 1995,another spike in 2001, and gradual linear path
role playing 1995, steady linear path 



Genre: Looking at the total sales in North America, Europe, Japan, and other Global regions by Genre

```{r}
regiongenresales <- vgsales %>%
  group_by( Genre) %>% 
  summarize(total_NA_genre_sum = sum(NA_Sales), 
            total_EU_genre_sum = sum(EU_Sales), 
            total_JP_genre_sum = sum(JP_Sales),
            total_other_genre_sum = sum(Other_Sales)) %>% 
  ungroup() %>% 
  complete(Genre) %>% 
  arrange(Genre) %>% 
  group_by(Genre) %>% 
  replace_na(list(total_NA_genre_sum = 0, 
                  total_EU_genre_sum = 0, 
                  total_JP_genre_sum = 0, 
                  total_other_genre_sum = 0)) %>% 
  filter(total_NA_genre_sum > 0)


g1 <- ggplot(regiongenresales) +
  geom_col(aes(x = total_NA_genre_sum,
               y = fct_reorder(Genre, total_NA_genre_sum),
               fill = factor(Genre))) +
  labs(x = "", 
       y = "", 
       title = "North American Sales by Genre") +
  theme(legend.position = "none") +
  scale_fill_manual(values = c("Action" = "red", 
                               "Role-Playing" = "blue"))

g2 <- ggplot(regiongenresales) +
  geom_col(aes(x = total_EU_genre_sum,
               y = fct_reorder(Genre, total_EU_genre_sum),
               fill = factor(Genre))) +
  labs(x = "", 
       y = "", 
       title ="European Sales by Genre") +
  theme(legend.position = "none") +
  scale_fill_manual(values = c("Action" = "red", 
                               "Role-Playing" = "blue"))

g3 <- ggplot(regiongenresales) +
  geom_col(aes(x = total_JP_genre_sum,
               y = fct_reorder(Genre, total_JP_genre_sum),
               fill = factor(Genre))) +
  labs(x = "", 
       y = "", 
       title = "Japanese Sales by Genre") +
  theme(legend.position = "none") +
  scale_fill_manual(values = c("Action" = "red", 
                             "Role-Playing" = "blue"))

g4 <- ggplot(regiongenresales) +
  geom_col(aes(x = total_other_genre_sum,
               y = fct_reorder(Genre, total_other_genre_sum),
               fill = factor(Genre))) +
  labs(x = "", 
       y = "", 
       title = "Other Region Sales by Genre") +
  theme(legend.position = "none") +
  scale_fill_manual(values=c("Action" = "red", 
                             "Role-Playing"= "blue"))


g1
g2
g3
g4
```

Platform: Looking at the total sales in North America, Europe, Japan, and other Global regions by platform

```{r}
vgsales %>% 
  group_by(Genre, Platform) %>% 
  summarise(tvs = sum(Global_Sales),tnavs = sum(NA_Sales)) %>% 
  arrange(Genre,desc(tvs))
```

```{r, fig.height=14, fig.width=12}
regionplatformsales <- vgsales %>%
  group_by(Platform, Genre) %>% 
  summarize(total_NA_platform_sum = sum(NA_Sales), 
            total_EU_platform_sum = sum(EU_Sales), 
            total_JP_platform_sum = sum(JP_Sales),
            total_other_platform_sum = sum(Other_Sales),
            total_global_platform_sum = sum(Global_Sales)) %>% 
  ungroup() %>% 
  complete(Platform) %>% 
  arrange(Platform) %>% 
  group_by(Platform) %>% 
  replace_na(list(total_NA_platform_sum = 0, total_EU_platform_sum  = 0, total_JP_platform_sum  = 0, total_other_platform_sum = 0)) %>% 
  mutate(cum_NA_plat_sum = cumsum(total_NA_platform_sum), 
         cum_EU_plat_sum = cumsum(total_EU_platform_sum),
         cum_JP_plat_sum = cumsum(total_JP_platform_sum),
         cum_other_plat_sum = cumsum(total_other_platform_sum),
         cum_global_plat_sum = cumsum(total_global_platform_sum)) 
  
p1 <- regionplatformsales %>% 
  filter(total_NA_platform_sum >0) %>% 
  ggplot()+
  geom_col(aes(x = total_NA_platform_sum,
             y = fct_reorder(Platform,cum_NA_plat_sum),
             fill = factor(Genre),
             group = Platform))+
  scale_fill_manual(values = c("red", "green","blue","black", "yellowgreen", "deeppink","cyan","darkmagenta","steelblue","midnightblue","gold", "green4"))+
  labs(x="", y= "", title ="North American Sales by Platform")

p2 <- regionplatformsales %>% 
  replace_na(list(cum_global_plat_sum = 0)) %>%
  filter(cum_global_plat_sum >0) %>% 
  ggplot()+
  geom_col(aes(x = total_EU_platform_sum,
             y = fct_reorder(Platform,cum_EU_plat_sum),
             fill = factor(Genre),
             group = Platform))+
  scale_fill_manual(values = c("red", "green","blue","black", "yellowgreen", "deeppink","cyan","darkmagenta","steelblue","midnightblue","gold", "green4")) +
  labs(x="", y= "", title ="European Sales by Platform")

p3 <- regionplatformsales %>% 
  filter(total_JP_platform_sum >0) %>% 
  ggplot()+
  geom_col(aes(x = total_JP_platform_sum,
             y = fct_reorder(Platform,cum_JP_plat_sum),
             fill = factor(Genre),
             group = Platform))+
  scale_fill_manual(values = c("red", "green","blue","black", "yellowgreen", "deeppink","cyan","darkmagenta","steelblue","midnightblue","gold", "green4"))+
  labs(x="", y= "", title ="Japanese Sales by Platform")

p4 <- regionplatformsales %>% 
  replace_na(list(cum_global_plat_sum = 0)) %>%
  filter(cum_global_plat_sum >0) %>% 
  ggplot()+
  geom_col(aes(x = total_other_platform_sum,
             y = fct_reorder(Platform,cum_other_plat_sum),
             fill = factor(Genre),
             group = Platform))+
  scale_fill_manual(values = c("red", "green","blue","black", "yellowgreen", "deeppink","cyan","darkmagenta","steelblue","midnightblue","gold", "green4"))+
  labs(x="", y= "", title ="Other Region Sales by Platform")

p5 <- regionplatformsales %>% 
  filter(total_global_platform_sum >0) %>% 
  ggplot()+
  geom_col(aes(x = total_global_platform_sum,
             y = fct_reorder(Platform,cum_global_plat_sum),
             fill = factor(Genre),
             group = Platform))+
  scale_fill_manual(values = c("red", "green","blue","black", "yellowgreen", "deeppink","cyan","darkmagenta","steelblue","midnightblue","gold", "green4"))+
  labs(x="", y= "", title ="Global Sales by Platform")

p1
p2
p3
p4
p5

```

Franchises

```{r}
vgsales %>%
  mutate(Name = ifelse(Name == "Minecraft: Story Mode", "Minecraft", Name)) %>%
  mutate(Name = ifelse(Name %in% c("Grand Theft Auto V","Grand Theft Auto: Liberty City Stories","Grand Theft Auto 2","Rockstar Games Double Pack: Grand Theft Auto III & Grand Theft Auto Vice City","Grand Theft Auto: Chinatown Wars","Grand Theft Auto: San Andreas","Grand Theft Auto: Vice City Stories","Grand Theft Auto IV","Grand Theft Auto: San Andreas","Grand Theft Auto: Mission Pack #1, London 1969","Grand Theft Auto: Vice City","Grand Theft Auto III"), "Grand Theft Auto", Name)) %>% 
  mutate(Name = ifelse(Name %in% c("Tetris", "Tetris Plus", 
                                   "Tetris DS","Tetris Worlds", 
                                   "Tetris DX", "Tetris 2 (All region sales)",
                                   "Tetris 2", "The Next Tetris", 
                                   "Tetris Party Deluxe", "Tetris Axis",
                                   "Tetris Online", "Tetrisphere",
                                   "Tetris 2 + Bombliss", "The New Tetris",
                                   "Tetris 2 (weekly jp sales)", 
                                   "Tetris Attack", "Tetris Worlds",
                                   "Magical Tetris Challenge", 
                                   "Tetris Worlds (Online Edition)", 
                                   "Star Wars: The Clone Wars & Tetris Worlds",
                                   "Tetris Attack", "Puyo Puyo Tetris",
                                   "Tetris Evolution", "Tetris Ultimate"),
                       "Tetris",Name)) %>% 
  mutate(Name = ifelse(Name %in% c("Super Mario Bros.","New Super Mario Bros.",
                                   "New Super Mario Bros. Wii", 
                                   "Super Mario Bros. 3", 
                                   "New Super Mario Bros. 2", 
                                   "Super Mario Bros. 2","Super Mario Bros. 3",
                                   "New Super Mario Bros. U",
                                   "Super Mario Bros.: The Lost Levels",
                                   "Mario Bros",
                                   "Classic NES Series: Super Mario Bros.",
                                   "Puzzle & Dragons Z + Super Mario Bros. Edition",
                                   "Famicom Mini: Super Mario Bros. 2",
                                   "Famicom Mini: Mario Bros."),"Mario", Name)) %>%
  mutate(Name = ifelse(Name %in% c("Pokemon Red/Pokemon Blue",
                                   "Pokemon Gold/Pokemon Silver",
                                   "Pokemon Diamond/Pokemon Pearl",
                                   "Pokemon Ruby/Pokemon Sapphire",
                                   "Pokemon Black/Pokemon White",
                                   "Pokemon X/Pokemon Y",
                                   "Pokemon HeartGold/Pokemon SoulSilver",
                                   "Pokemon Omega Ruby/Pokemon Alpha Sapphire","Pokemon FireRed/Pokemon LeafGreen","Pokemon Black 2/Pokemon White 2","Pokemon Stadium","Pokemon Pinball","Pokemon Mystery Dungeon: Explorers of Time/Explorers of Darkness","Pokemon Snap","Pokemon Ranger: Shadows of Almia","Pokemon Ranger","Pokemon Mystery Dungeon: Red/Blue Rescue Team","Pokemon Battle Revolution","Pokemon Mystery Dungeon: Explorers of Sky","Pokemon Pinball: Ruby & Sapphire","Pokemon Ranger: Guardian Signs","Pokemon Mystery Dungeon: Gates to Infinity","Pokemon XD: Gale of Darkness","Pokemon Super Mystery Dungeon","Pokemon Rumble Blast","Pokemon Conquest","Pokemon Card GB2: Here Comes Team GR!","Pokemon Dash","Pokemon Trozei!","Pokemon Art Academy","Pokemon Puzzle League", "Pokemon Channel", "Battle & Get! Pokemon Typing DS","Pokemon Box: Ruby & Sapphire","Pokemon Rumble World","Pok?mon Platinum Version","Pok?mon Emerald Version","Pok?mon Crystal Version","Pok?mon Stadium 2","Pok?mon Colosseum","Pok?mon Mystery Dungeon: Blue Rescue Team", "Pok?Park Wii: Pikachu's Adventure","	Pok?mon Mystery Dungeon: Red Rescue Team (US weekly sales)","Pokken Tournament", "PokePark 2: Wonders Beyond","Pok?mon I Choose You / Squirtle Squad Game Boy Advance Video", "Pok?mon Beach Blank-out Blastoise / Go West Young Meowth Game Boy Advance Video", "Pok?mon: Johto Photo Finish: Game Boy Advance Video","Pok?mon: For Ho-Oh the Bells Toll!: Game Boy Advance Video", "Hey You, Pikachu!"), "Pokemon", Name)) %>% 
  group_by(Name) %>% 
  summarise(tgvs = sum(Global_Sales)) %>% 
  filter(Name =="Minecraft" | Name == "Grand Theft Auto" | Name == "Tetris"|
         Name == "Mario" | Name == "Pokemon")
```


Individual Games: Looking at what games were the most popular and had the most sales over time

```{r, fig.height = 6.5, fig.width = 10}
vgsales %>% 
  group_by(Name,Genre) %>% 
  summarize(total_gs = sum(Global_Sales)) %>% 
  filter(total_gs>20) %>% 
  arrange(desc(total_gs)) %>% 
  ggplot(aes(x = total_gs,
             y = fct_reorder(Name, total_gs),
             fill = Genre)) +
  geom_col() +
  scale_fill_manual(values = c("red","black", "yellow", "deeppink", "cyan",
                              "darkmagenta","steelblue","midnightblue","gold")) +
  labs(x = "", 
       y = "", 
       title = "Most Popular Games by Global Sales") 
```

Action: 3 games
Misc: 4 games
Platform: 6 games
Puzzle: 1 game
Racing: 2 games
Role-playing: 2 games 
Shooter: 7 games
Simulation: 1 games 
Sports: 4 games 