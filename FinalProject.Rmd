---
title: "Final Project Graph"
author: "Brian Anderson"
output: 
  html_document:
    df_print: paged
    code_download: true
    theme: cerulean
---

```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = TRUE, error=TRUE, message=FALSE, warning=FALSE)
```

```{r libraries}
library(tidyverse)     # for graphing and data cleaning
library(lubridate)     # for date manipulation
library(ggthemes)      # for even more plotting theme
library(gganimate)     # for adding animation layers to ggplots
library(transformr)    # for "tweening" (gganimate)
library(gifski)        # for creating the gif
library(shiny)         # for creating interactive apps
library(readr)
theme_set(theme_minimal()) # My favorite ggplot() theme :)
```

## Data choice 1: Video Game Sales

```{r}
vgsales <- read.csv("vgsales.csv")
view(vgsales)
```

### Tidy Tuesday Graph

Title: In the YAML section of the document. A descriptive title & list of all group members.
 
Daniel Beidelshcies and Brian Anderson
Introduction and background: An introduction that motivates & outlines a clear, specific set of research questions. Also, provide some background on your topic.
Introduction
Since the advancement of technology, the creation of video games has played an influential role in being a source of entertainment for everyone around the world. Everyone is able to find a game that they like in order to pass time and fulfill their creative needs. 
Background information
We have always been interested in video games and wondered how the sales of these games differed across the world as we grew up in different regions.
Research Questions
What are the most selling platforms of games over the years across different regions?
What is the most selling genre of games over the years across different regions?
Who is the most selling publisher of games over the years across different regions?
Data collection: Specification of your data sources and collection process.
Scraping from Kaggle and importing to a dataset
Analysis: This is the bulk of the report which either has a presentation of the groupâ€™s key findings and take-aways or gives the detail of how someone would interact and what people should take away from the shiny app. If you choose to do a shiny app, be sure to include a link to the shinyapps.io site.

```{r, fig.alt = Animated BAr Chart showin cumulative video game sales by genre from 1980-2020}
vgsales %>%
  group_by( Year,Genre) %>% 
  summarize(total_genre_sum = sum(Global_Sales)) %>% 
  ungroup() %>% 
  complete(Year,Genre) %>% 
  arrange(Genre,Year) %>% 
  group_by(Genre) %>% 
  replace_na(list(total_genre_sum = 0)) %>% 
  mutate(cum_genre_sum = cumsum(total_genre_sum)) %>%
  filter(cum_genre_sum > 0) %>% 
  filter(n()>=13) %>% 
  top_n(n = 12,wt = cum_genre_sum) %>% 
  arrange(Year,desc(cum_genre_sum)) %>% 
  mutate(rank = 1:n()) %>% 
  ggplot(aes(x = cum_genre_sum,
             y = factor(rank),
             fill = Genre,
             group = Genre)) +
  geom_col() +
  geom_text(aes(label = Genre),
            color = "white",
            hjust = "right") +
  labs(title = "Popular Video Game Genres based on Worldwide Sales",
       subtitle = "Year: {frame_time}",
       x = "", 
       y = "",
       caption = "Plot created by Brian Anderson, Data from Vgsales") + 
  transition_time(Year)

```

```{r}
regiongenresales <- vgsales %>%
  group_by( Year,Genre) %>% 
  summarize(total_NA_genre_sum = sum(NA_Sales), 
            total_EU_genre_sum = sum(EU_Sales), 
            total_JP_genre_sum = sum(JP_Sales),
            total_other_genre_sum = sum(Other_Sales)) %>% 
  ungroup() %>% 
  complete(Year,Genre) %>% 
  arrange(Genre,Year) %>% 
  group_by(Genre) %>% 
  replace_na(list(total_NA_genre_sum = 0, total_EU_genre_sum  = 0, total_JP_genre_sum  = 0, total_other_genre_sum = 0)) %>% 
  mutate(cum_NA_genre_sum = cumsum(total_NA_genre_sum), cum_EU_genre_sum = cumsum(total_EU_genre_sum),cum_JP_genre_sum = cumsum(total_JP_genre_sum),cum_other_genre_sum = cumsum(total_other_genre_sum))  


p1 <- ggplot(regiongenresales)+
  geom_col(aes(x = cum_NA_genre_sum,
             y = Genre,
             fill = Genre,
             group = Genre))

p2 <- ggplot(regiongenresales)+
  geom_col( aes(x = cum_EU_genre_sum,
             y = Genre,
             fill = Genre,
             group = Genre))

p3 <- ggplot(regiongenresales)+
  geom_col(aes(x = cum_JP_genre_sum,
             y = Genre,
             fill = Genre,
             group = Genre))

p4 <- ggplot(regiongenresales )+
  geom_col(aes(x = cum_other_genre_sum,
             y = Genre,
             fill = Genre,
             group = Genre))


p5 <- p1+p2+p3+p4

p5


```
```{r}
regionplatformsales <- vgsales %>%
  group_by( Year,Platform) %>% 
  summarize(total_NA_platform_sum = sum(NA_Sales), 
            total_EU_platform_sum = sum(EU_Sales), 
            total_JP_platform_sum = sum(JP_Sales),
            total_other_platform_sum = sum(Other_Sales)) %>% 
  ungroup() %>% 
  complete(Year,Platform) %>% 
  arrange(Platform,Year) %>% 
  group_by(Platform) %>% 
  replace_na(list(total_NA_platform_sum = 0, total_EU_platform_sum  = 0, total_JP_platform_sum  = 0, total_other_platform_sum = 0)) %>% 
  mutate(cum_NA_platform_sum = cumsum(total_NA_platform_sum), cum_EU_platform_sum = cumsum(total_EU_platform_sum),cum_JP_platform_sum = cumsum(total_JP_platform_sum),cum_other_platform_sum = cumsum(total_other_platform_sum))  


p1 <- ggplot(regionplatformsales)+
  geom_col(aes(x = cum_NA_platform_sum,
             y = Platform,
             fill = Platform,
             group = Platform))

p2 <- ggplot(regionplatformsales)+
  geom_col( aes(x = cum_EU_platform_sum,
             y = Platform,
             fill = Platform,
             group = Platform))

p3 <- ggplot(regionplatformsales)+
  geom_col(aes(x = cum_JP_platform_sum,
             y = Platform,
             fill = Platform,
             group = Platform))

p4 <- ggplot(regionplatformsales )+
  geom_col(aes(x = cum_other_platform_sum,
             y = Platform,
             fill = Platform,
             group = Platform))


p5 <- p1+p2+p3+p4

p5

```

```{r}
regionpublishersales <- vgsales %>%
  group_by( Year,Publisher) %>% 
  summarize(total_NA_publisher_sum = sum(NA_Sales), 
            total_EU_publisher_sum = sum(EU_Sales), 
            total_JP_publisher_sum = sum(JP_Sales),
            total_other_publisher_sum = sum(Other_Sales)) %>% 
  ungroup() %>% 
  complete(Year,Publisher) %>% 
  arrange(Publisher,Year) %>% 
  group_by(Publisher) %>% 
  replace_na(list(total_NA_publisher_sum = 0, total_EU_publisher_sum  = 0, total_JP_publisher_sum  = 0, total_other_publisher_sum = 0)) %>% 
  mutate(cum_NA_publisher_sum = cumsum(total_NA_publisher_sum), cum_EU_publisher_sum = cumsum(total_EU_publisher_sum),cum_JP_publisher_sum = cumsum(total_JP_publisher_sum),cum_other_publisher_sum = cumsum(total_other_publisher_sum))  


p1 <- ggplot(regionpublishersales)+
  geom_col(aes(x = cum_NA_publisher_sum,
             y = Publisher,
             fill = Publisher,
             group = Publisher))

p2 <- ggplot(regionpublishersales)+
  geom_col( aes(x = cum_EU_publisher_sum,
             y = Publisher,
             fill = Publisher,
             group = Publisher))

p3 <- ggplot(regionpublishersales)+
  geom_col(aes(x = cum_JP_publisher_sum,
             y = Publisher,
             fill = Publisher,
             group = Publisher))

p4 <- ggplot(regionpublishersales)+
  geom_col(aes(x = cum_other_publisher_sum,
             y = Publisher,
             fill = Publisher,
             group = Publisher))


p5 <- p1+p2+p3+p4

p5
```


